---
sidebar_position: 5
hide_table_of_contents: true
sidebar_label: 代理
---

import DocCardList from "@theme/DocCardList";

# 代理

:::info
[概念指南](../../concepts/) • [操作指南](../../how-to/)
:::

代理通过允许语言模型根据用户输入动态选择使用哪些工具来实现自主行为。与预定的链不同，代理对其行动做出实时决策。

## 核心概念

代理系统由几个关键组件组成：

- **代理**：选择使用哪些工具的决策组件
- **工具**：代理可以调用的可用函数/API
- **执行器**：管理代理的执行循环和工具调用
- **内存**：在代理交互中维护对话上下文

## 代理工作原理

1. **接收输入**：代理接收用户查询或任务
2. **规划行动**：代理分析输入并决定使用哪些工具
3. **执行工具**：代理使用适当的参数调用选定的工具
4. **处理结果**：代理评估工具的输出
5. **决定下一步**：代理确定是否需要更多行动或任务是否完成
6. **响应**：代理向用户提供最终响应

## 代理类型

### MRKL 代理 (ReAct)
使用推理和行动模式，代理在思考要做什么和采取行动之间交替。

### OpenAI 函数代理
利用 OpenAI 的函数调用功能进行更结构化的工具使用和参数传递。

### 对话代理
专为多轮对话设计，在使用工具协助任务时保持上下文。

### 计划和执行代理
首先创建行动计划，然后系统地执行每个步骤。

## 可用工具

LangChainGo 提供了几个内置工具：

- **计算器**：执行数学计算
- **网络搜索**：在互联网上搜索信息
- **文件操作**：读取、写入和操作文件
- **数据库查询**：执行数据库操作
- **API 调用**：对外部服务进行 HTTP 请求
- **自定义工具**：为特定用例创建您自己的工具

## 构建代理

### 基本代理设置

```go
// 创建工具
tools := []tools.Tool{
    tools.Calculator{},
    tools.WebSearch{APIKey: "your-api-key"},
}

// 创建代理
agent := agents.NewOneShotAgent(llm, tools)

// 创建执行器
executor := agents.NewExecutor(agent)

// 执行
result, err := executor.Call(ctx, map[string]any{
    "input": "25 * 4 等于多少，今天的天气如何？",
})
```

### 自定义工具

```go
type CustomTool struct{}

func (c CustomTool) Name() string {
    return "custom_tool"
}

func (c CustomTool) Description() string {
    return "执行自定义操作"
}

func (c CustomTool) Call(ctx context.Context, input string) (string, error) {
    // 您的自定义逻辑在这里
    return "工具结果", nil
}
```

## 最佳实践

1. **工具选择**：选择相互补充并覆盖您用例的工具
2. **提示工程**：设计清晰的工具描述和代理提示
3. **错误恢复**：为工具故障实施回退策略
4. **资源管理**：设置工具执行的超时和限制
5. **安全性**：验证工具输入并清理输出
6. **监控**：跟踪代理性能和决策质量

## 代理组件

<DocCardList />